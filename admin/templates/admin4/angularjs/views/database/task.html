<style>
	.webuploader-pick {
		display: block;
		padding: 0;
		background: #3598dc;
	}
	#createData {
		min-width: 100px;
	}
	.createFile div:nth-child(2){width:100%!important;height:100%!important;}
	.opreat {
		font-size: 16px;
		width:20px;
		color: #45B6AF;
		cursor: pointer;
	}
	.list-icon {
		font-size: 18px;
		width:20px;
		color: #45B6AF;
	}
</style>
<div class="row" ng-controller="xiticeCtrl">
	<div style="position: absolute;right: 10px; top: 35px;">
		<span style="color: #3175af;margin-right:5px;">跳转至&nbsp;&nbsp;<i class="fa fa-mail-forward"></i></span>
		<div class="btn-group btn-group-sm btn-group-solid">
			<button type="button" class="btn red" onclick="common.goUrl('assistant', true)">备课参考</button>
			<button type="button" class="btn green" onclick="common.goUrl('knowledgePoint', true)">知识点题库</button>
			<button type="button" class="btn blue" onclick="common.goUrl('courseEdit', true)">课程信息</button>
		</div>
	</div>
	<!--<div data-ng-include="'views/template/zhishidian.html'"></div>-->
	<div class="col-md-4">
		<div class="portlet light" style="min-height: 500px;">
			<div class="portlet-title">
				<div class="caption font-green-sharp">
					<i class="icon-settings font-green-sharp"></i>
					<span class="caption-subject bold uppercase">章节目录</span>
					<span class="caption-helper hide"></span>
				</div>
			</div>
			<div class="portlet-body">
				<div data-ng-include="'views/template/nodeTree.html'"></div>
			</div>
		</div>

	</div>

	<div class="col-md-8">
		<!-- BEGIN: ACCORDION DEMO -->
		<div class="portlet light" style="min-height: 100px;">
			<div class="portlet-title tabbable-line">
				<div class="caption font-green-sharp">
					<i class="icon-settings font-green-sharp"></i>
					<span class="caption-subject bold uppercase">任务和风暴{{currKP}}</span>
				</div>
				<div class="actions">
					<button class="btn btn-circle red-sunglo btn-sm" ng-click="openExercisesBookModel()">
						<i class="fa fa-plus"></i> 创建 </button>
				</div>
				<ul class="nav nav-tabs">
					<li class="active">
						<a data-target="#tab_task_1" data-toggle="tab"> 任务 </a>
					</li>
					<li>
						<a data-target="#tab_task_2" data-toggle="tab"> 风暴 </a>
					</li>
				</ul>
			</div>
			<div class="portlet-body">
				<div class="tab-content">
					<div class="tab-pane active" id="tab_task_1">
						<div class="scroller" style="min-height: 200px;" data-always-visible="1" data-rail-visible1="0" data-handle-color="#D7DCE2">
							<ul class="feeds">
								<!--<li ng-repeat="row in tiwence">
									<div class="col1">
										<div class="cont">
											<div class="cont-col1">
												<div class="label label-sm label-danger">问</div>
											</div>
											<div class="cont-col2">
												<div class="desc">
													{{row.exeBookName}}
												</div>
											</div>
										</div>
									</div>
									<div class="col2">
										<div class="date">
											<i class="fa fa-edit opreat" class="list-icon" style="padding-right: 23px;border-right: 1px solid #45B6AF;" title="编辑" ng-click="editExercisesBook(row.id)"></i>
											<i class="fa fa-trash-o opreat" class="list-icon" title="删除" id="del(row.id)"></i>
										</div>
									</div>
								</li>-->
								<li>
									<div class="col1">
										<div class="cont">
											<div class="cont-col1">
												<div class="label label-sm label-danger">任</div>
											</div>
											<div class="cont-col2">
												<div class="desc">
													任务册1
												</div>
											</div>
										</div>
									</div>
									<div class="col2">
										<div class="date">
											<i class="fa fa-edit opreat" class="list-icon" style="padding-right: 23px;border-right: 1px solid #45B6AF;" title="编辑" ng-click="editExercisesBook(row.id)"></i>
											<i class="fa fa-trash-o opreat" class="list-icon" title="删除" id="del(row.id)"></i>
										</div>
									</div>
								</li>
							</ul>

						</div>
					</div>
					<div class="tab-pane" id="tab_task_2">
						<ul class="feeds">
							<!--<li ng-repeat="row in lianxice">
								<div class="col1">
									<div class="cont">
										<div class="cont-col1">
											<div class="label label-sm label-danger">习</div>
										</div>
										<div class="cont-col2">
											<div class="desc">
												{{row.exeBookName}}
											</div>
										</div>
									</div>
								</div>
								<div class="col2">
									<div class="date">
										<i class="fa fa-edit opreat" class="list-icon" style="padding-right: 23px;border-right: 1px solid #45B6AF;" title="编辑" ng-click="editExercisesBook(row.id)"></i>
										<i class="fa fa-trash-o opreat" class="list-icon" title="删除" id="del(row.id)"></i>
									</div>
								</div>
							</li>-->
							<li>
								<div class="col1">
									<div class="cont">
										<div class="cont-col1">
											<div class="label label-sm label-danger">暴</div>
										</div>
										<div class="cont-col2">
											<div class="desc">
												头脑风暴册1
											</div>
										</div>
									</div>
								</div>
								<div class="col2">
									<div class="date">
										<i class="fa fa-edit opreat" class="list-icon" style="padding-right: 23px;border-right: 1px solid #45B6AF;" title="编辑" ng-click="editExercisesBook(row.id)"></i>
										<i class="fa fa-trash-o opreat" class="list-icon" title="删除" id="del(row.id)"></i>
									</div>
								</div>
							</li>
						</ul>
					</div>
				</div>
			</div>
		</div>
		<!-- END: ACCORDION DEMO -->
	</div>
	
	<!--创建或修改任务和风暴-->
	<div class="modal fade" id="taskModal" tabindex="-1" role="dialog" aria-hidden="true">
		<div class="modal-dialog modal-lg">
			<div class="modal-content">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal" aria-hidden="true"></button>
					<h4 class="modal-title">创建任务和风暴册</h4>
				</div>
				<div class="modal-body">
					<div class="portlet">
						<div class="portlet-body">
							<div role="form">
								<div class="form-body">
									<div class="row" style="margin-bottom: 40px;">
										<div class="col-md-6">
											<div class="form-group form-md-line-input">
												<input type="text" class="form-control" ng-model="list.exeBookName" placeholder="册子名称" />
												<label for="form_control_1">名称</label>
												<span class="help-block">名称不得超过50个字符</span>
											</div>
										</div>
										
										<div class="col-md-6">
											<div class="form-group form-md-radios">
												<label>册子类型</label>
												<div class="md-radio-inline">
													<div class="md-radio">
														<input type="radio" id="exeBookType1" name="exeBookType" class="md-radiobtn" value="1" checked="">
														<label for="exeBookType1">
														<span></span>
														<span class="check"></span>
														<span class="box"></span>
														任务册 </label>
													</div>
													<div class="md-radio">
														<input type="radio" id="exeBookType2" name="exeBookType" class="md-radiobtn" value="2">
														<label for="exeBookType2">
														<span></span>
														<span class="check"></span>
														<span class="box"></span>
														头脑风暴册 </label>
													</div>
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
					<div class="form-actions noborder" style="text-align: center;margin-bottom: 10px;">
						<button type="button" class="btn blue" ng-click="sub()">提交</button>
					</div>
				</div>
			</div>
			<!-- /.modal-content -->
		</div>
		<!-- /.modal-dialog -->
	</div>

</div>
<!-- END MAIN CONTENT -->
<!-- BEGIN MAIN JS-->
<script>
	function xiticeCtrl($scope, $http, $stateParams, $rootScope) {
		var courseId = localStorage.getItem('courseId');
		
		//添加册子回调
		$scope.$on('exercisesBookChange', function(d,data) {  
	        $scope.loadQuestionList("1");
		    $scope.loadQuestionList("2");
		    $scope.loadQuestionList("3");
	    });
	    
	    //切换章节回调
		$scope.$on('currentNode', function(d,data) {  
			$scope.loadQuestionList("1");
		    $scope.loadQuestionList("2");
		    $scope.loadQuestionList("3");
	    });
	    
	    //加载习题册   type： 1、提问册  2、练习册  3、作业册
	    $scope.loadQuestionList = function(type) {
	    	common.ajax2({
	        	$scope: $scope,
				$http: $http,
				data: {
				  "allOrPart": "part",
				  "exeBookType": type,
				  "operatorId": localStorage.getItem('userid'),
				  "page": 0,
				  "chapterId": localStorage.getItem('currentNodeId'),
				  "size": 20,
				  "sort": 1,
				  "sorting": "uTime"
				},
				url: '/exerciseBook/findAll/detailed',
				success: function(res) {
					if(type == "1") {
						$scope.tiwence = res.data;
					}else if(type == "2") {
						$scope.lianxice = res.data;
					}else if(type == "3") {
						$scope.zuoyece = res.data;
					}
				}
	        });
	    };
	    $scope.loadQuestionList("1");
	    $scope.loadQuestionList("2");
	    $scope.loadQuestionList("3");
	    
	    //修改提题册
	    $scope.editExercisesBook = function(id) {
	    	$scope.$broadcast('editExercisesBookId', id);
	    	$("#exercisesBookEditModal").modal("show");
	    }
	    
	    //打开习题册编辑框
	    $scope.openExercisesBookModel = function() {
	    	if(!$rootScope.currentNode) {
	    		layer.alert("请先选择章节");
	    		return false;
	    	}
	    	
	    	layer.confirm("您确定要为--("+$rootScope.currentNode.text+")--章节任务或头脑风暴册吗", {
			  btn: ['确定', "取消"] //按钮
			}, function(){
			  $("#taskModal").modal("show");
			  layer.closeAll('dialog');
			});
	    }

	}
</script>
<!-- BEGIN MAIN JS -->