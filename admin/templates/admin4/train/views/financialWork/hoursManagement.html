<link href="../../../assets/admin/pages/css/profile-old.css" rel="stylesheet">
<link href="../../../assets/global/plugins/bootstrap-datetimepicker/css/bootstrap-datetimepicker.min.css" rel="stylesheet">
<style>
	.label-text {
		margin-top: 8px;
	}
	
	.abslute {
		margin-left: -100px;
		margin-top: 3px;
		width: 46px;
		height: 28px;
	}
	
	.table-toolbar {
		border-bottom: 3px solid #ddd;
		border-width: 100%;
	}
	
	.dividing {
		border-bottom: 3px solid #ddd;
		top: -23px;
		position: relative;
	}
</style>
<div class="row" ng-controller="hmCtrl">
	<div class="col-md-12">
		<!-- BEGIN EXAMPLE TABLE PORTLET-->
		<div class="portlet box grey-cascade">
			<div class="portlet-title">
				<div class="caption">
					<i class="fa fa-globe"></i>财务类型维护
				</div>
			</div>
			<div class="portlet-body">
				<table class="table table-striped table-bordered table-hover">
					<thead>
						<tr>
							<th>操作</th>
							<th>类型名称</th>
							<th>收入/支出</th>
							<th>创建时间</th>
						</tr>
					</thead>
					<tbody>
						<tr class="odd gradeX" ng-repeat="item in data">
							<td style="min-width: 150px;">
								<button ng-show='!item.edit' class="btn btn-info btn-sm" ng-click="add($index)">新增</button>
								<button ng-show='!item.edit' class="btn btn-info btn-sm" ng-click="edit(item)">编辑</button>
								<button ng-show='!item.edit' class="btn btn-info btn-sm" ng-click="del(item)">删除</button>
								<button ng-show='item.edit' class="btn btn-info btn-sm" ng-click="save(item)">保存</button>
								<button ng-show='item.edit' class="btn btn-info btn-sm" ng-click="cancel(item, $index)">取消</button>
							</td>
							<td>
								<span ng-show='!item.edit'>{{item.name}}</span>
								<input ng-show='item.edit' type="text" ng-model="item.name" />
							</td>
							<td>支出</td>
							<td>2019-6-4</td>
						</tr>
					</tbody>
				</table>
			</div>
		</div>
		<!-- END EXAMPLE TABLE PORTLET-->
	</div>

</div>
<script src="../../../assets/global/plugins/bootstrap-datetimepicker/js/bootstrap-datetimepicker.min.js" type="text/javascript"></script>
<script src="../../../assets/global/plugins/bootstrap-datetimepicker/js/locales/bootstrap-datetimepicker.zh-CN.js" type="text/javascript"></script>
<script>
	function hmCtrl($scope, $http, $rootScope) {
		$scope.data = [
			{name: '差旅费'},
			{name: '课时补贴费'}
		]
		
		$scope.add = function(index) {
			$scope.flag = 'add';
			$scope.data.splice(index+1, 0, {
				edit: true
			});
		};
		
		$scope.edit = function(major) {
			$scope.flag = 'edit';
			major.edit = true;
		}
		
		$scope.save = function(major) {
			common.ajax({
				$scope: $scope,
				$http: $http,
				data: major,
				operate: true,
				url: '/specialty/saveUpdate',
				success: function(res) {
					console.log(res);
					major.edit = false;
				}
			});
		};
		
		$scope.cancel = function(major, index) {
			if($scope.flag == 'add') {
				$scope.data.splice(index, 1);
			}else if($scope.flag == 'edit') {
				major.edit = false;				
			}
		};		
		
		$scope.del = function(major) {
			common.ajax({
				$scope: $scope,
				$http: $http,
				operate: true,
				data: major,
				tip: '您确定要删除该专业吗？',
				url: '/specialty/deleteBySpecialtyId',
				success: function(res) {
					$scope.loadDataList();
				}
			});
		};
		
		$('.form_datetime').datetimepicker({
      format: 'yyyy-mm',
      autoclose: true,
      todayBtn: true,
      startView: 'year',
      minView:'year',
      maxView:'decade',
      language:'zh-CN'
    });
		
	}
</script>